$schema: https://azuremlschemas.azureedge.net/latest/sweepJob.schema.json
type: sweep
experiment_name: diabetes_tuning_experiment
description: Hyperparameter tuning for logistic regression reg_rate parameter

# Replace with your Azure ML compute name (use azureml:<compute-name>)
compute: amlcluster

objective:
  goal: maximize
  primary_metric: training_f1_score

sampling_algorithm: random

# top-level inputs/outputs (moved from trial)
inputs:
  training_data:
    path: azureml:diabetes-dev-folder@latest

outputs:
  model:
    type: uri_folder
    mode: upload

search_space:
  reg_rate:
    type: uniform
    min_value: 0.001
    max_value: 0.1
  test_size:
    type: choice
    values: [0.2, 0.25, 0.3]

trial:
  command: >-
    python train.py
    --training_data ${{ inputs.training_data }}
    --reg_rate ${{ search_space.reg_rate }}
    --test_size ${{ search_space.test_size }}
    --output ${{ outputs.model }}
  code: model
  environment: azureml:AzureML-sklearn-0.24-ubuntu18.04-py37-cpu@latest

limits:
  max_total_trials: 10
  max_concurrent_trials: 3
  timeout: 3600
